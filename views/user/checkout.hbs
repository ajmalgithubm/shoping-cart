<div class="row p-5">
    <div class="col-md-8 mb-4">
        <div class="card mb-4">
            <div class="card-header py-3">
                <h5 class="mb-0">Biling details</h5>
            </div>
            <div class="card-body">
                <form action="/make-purchase" method="post">
                    <!-- 2 column grid layout with text inputs for the first and last names -->
                    <div class="row mb-4">
                        <div class="col">
                            <div class="form-outline">
                                <label class="form-label" for="fname">First name</label>
                                <input type="text" id="fname" name="fname" class="form-control" />
                                <small style="color: red;" id="fnameAlert">Enter the first name</small>
                            </div>
                        </div>
                        <div class="col">
                            <div class="form-outline">
                                <label class="form-label" for="lname">Last name</label>
                                <input type="text" id="lname" name="lname" class="form-control" />
                                <small style="color: red;" id="lnameAlert">Enter the last name</small>
                            </div>
                        </div>
                    </div>

                    <!-- Text input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="address">Address</label>
                        <input type="text" id="address" name="address" class="form-control" />
                        <small style="color: red;" id="addressAlert">Enter the full address</small>
                    </div>

                    <!-- Email input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="email">Email</label>
                        <input type="email" id="email" name="email" class="form-control" />
                        <small style="color: red;" id="emailAlert">Enter the valid email address</small>
                    </div>

                    <!-- Number input -->
                    <div class="form-outline mb-4">
                        <label class="form-label" for="phoneNumber">Phone</label>
                        <input type="number" id="phoneNumber" name="phoneNumber" class="form-control" />
                        <small style="color: red;" id="phoneAlert">Enter the phone number</small>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <div class="col-md-4 mb-4">
        <div class="card mb-4">
            <div class="card-header py-3">
                <h5 class="mb-0">Summary</h5>
            </div>
            <div class="card-body">
                <ul class="list-group">
                    <li class="list-group-item d-flex align-items-center border-0 px-0 pb-0">
                        <input type="checkbox" name="cod" id="cod" class=""><span class="ml-2"
                            style="font-weight: 600;">COD</span>
                    </li>
                    <li class="list-group-item d-flex  align-items-center px-0">
                        <input type="checkbox" name="onlinePayment" id="onlinePayment"><span class="ml-2"
                            style="font-weight: 600;">ONLINE PAYMENT</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 mb-3">
                        <div>
                            <strong>Total amount</strong>
                        </div>
                        <span><strong>$<sapn>{{totalCartPrice}}</sapn></strong></span>
                    </li>
                </ul>

                <button type="button" class="btn btn-primary btn-lg btn-block" onclick="makePurchase()">
                    Make purchase
                </button>
            </div>
        </div>
    </div>
</div>

<style>
    #fnameAlert {
        display: none;
    }

    #lnameAlert {
        display: none;
    }

    #addressAlert {
        display: none;
    }

    #phoneAlert {
        display: none;
    }
    #emailAlert{
        display: none;
    }
    .form-control{
        box-shadow: 0px 0 5px rgb(75, 74, 74);
    }
</style>

<script>
    var firstName = document.getElementById('fname');
    var lastName = document.getElementById('lname');
    var email = document.getElementById('email');
    var address = document.getElementById('address');
    var phoneNumber = document.getElementById('phoneNumber');
    var cod = document.getElementById('cod')
    var onlinePayment = document.getElementById('onlinePayment')
    const fnameAlert = document.getElementById('fnameAlert')
    const lnameAlert = document.getElementById('lnameAlert')
    const addressAlert = document.getElementById('addressAlert')
    const phoneAlert = document.getElementById('phoneAlert')
    const emailAlert = document.getElementById('emailAlert')

    // first name form validation
    firstName.addEventListener('focus', function () {
        fnameAlert.style.display = 'none';
        firstName.style.boxShadow = 'none'
        firstName.style.border = "2px solid blue";
    })
    firstName.addEventListener('blur', function () {
        if (firstName.value.trim() === '') {
            firstName.style.boxShadow = '0 0 5px red';
            firstName.style.border = 'none'
            fnameAlert.style.display = 'block';
        } else {
            firstName.style.border = '';
            firstName.style.boxShadow = 'none'
        }

    })
    // last name form validation
    lastName.addEventListener('focus', function () {
        lnameAlert.style.display = 'none';
        lastName.style.boxShadow = 'none'
        lastName.style.border = "2px solid blue";
    })
    lastName.addEventListener('blur', function () {
        if (lastName.value.trim() === '') {
            lastName.style.boxShadow = '0 0 5px red';
            lastName.style.border = 'none'
            lnameAlert.style.display = 'block';
        } else {
            lastName.style.border = '';
            lastName.style.boxShadow = 'none'
        }

    })
    // email validation
    email.addEventListener('focus', function () {
        emailAlert.style.display = 'none';
        email.style.border = "2px solid blue";
        email.style.boxShadow = 'none'
    })
    email.addEventListener('blur', function () {
        if (!emailIsValid(email.value)) {
            email.style.boxShadow = '0 0 5px red';
            emailAlert.style.display = 'block';
            email.style.border = '';
        }else{
            email.style.border = '';
            email.style.boxShadow = 'none'
        }
        
    })
    // address   validation
    address.addEventListener('focus',function(){
        addressAlert.style.display = 'none';
        address.style.border = "2px solid blue";
        address.style.boxShadow = 'none'
    })
    address.addEventListener('blur', function(){
        if(address.value.trim() === ''){
            address.style.boxShadow = '0 0 5px red';
            addressAlert.style.display = 'block';
            address.style.border = ''
        }else{
            address.style.border = ''
        }
    })

    function makePurchase() {
        const data = {
            firstName: firstName.value,
            lastName: lastName.value,
            email: email.value,
            address: address.value,
            phoneNumber: phoneNumber.value,
            cod: cod.checked,
            onlinePayment: onlinePayment.checked
        }
        if (firstName.value.trim() === '') {
            fnameAlert.style.display = 'block';
            firstName.style.boxShadow = "0 0 5px red"
            firstName.focus()
        } if (address.value.trim() === '') {
            addressAlert.style.display = 'block';
            address.style.boxShadow = "0 0 5px red"
            lastName.focus()
        } if (phoneNumber.value.trim() === '') {
            phoneAlert.style.display = 'block';
            phoneNumber.style.boxShadow = "0 0 5px red"
            phoneNumber.focus()
        }
        console.log(data)
    }

    function emailIsValid(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }
</script>